{% assign locale_prefix = request.locale.iso_code | downcase | slice: 0, 2 %}
{% assign use_locale_copy = false %}
{% unless locale_prefix == 'de' %}
  {% assign use_locale_copy = true %}
{% endunless %}

{% assign faq_heading = section.settings.heading %}
{% if use_locale_copy or faq_heading == blank %}
  {% assign faq_heading = 'sections.faq.heading' | t %}
{% endif %}

{% assign faq_subheading = section.settings.subheading %}
{% if use_locale_copy or faq_subheading == blank %}
  {% assign faq_subheading = 'sections.faq.subheading' | t %}
{% endif %}

{% assign faq_help_text = section.settings.help_text %}
{% if use_locale_copy or faq_help_text == blank %}
  {% assign faq_help_text = 'sections.faq.help_link' | t %}
{% endif %}

{% assign faq_help_suffix = section.settings.help_suffix %}
{% if use_locale_copy or faq_help_suffix == blank %}
  {% assign faq_help_suffix = 'sections.faq.help_suffix' | t %}
{% endif %}

<section class="faq">
  <div class="faq-left">
    <h2>{{ faq_heading }}</h2>
    <p>{{ faq_subheading }} <a href="{{ section.settings.help_url | default: pages['hilfe'].url | default: '/pages/hilfe' }}#hilfecenter" class="faq-link">{{ faq_help_text }}</a> – {{ faq_help_suffix }}</p>
  </div>

  <div class="faq-right">
    {% for block in section.blocks %}
      {% if block.type == 'question' %}
        {% assign is_first = false %}
        {% if forloop.first %}{% assign is_first = true %}{% endif %}
        {% assign faq_question = block.settings.question %}
        {% assign faq_answer = block.settings.answer %}
        {% assign faq_question_key = '' %}
        {% assign faq_answer_key = '' %}
        {% case forloop.index %}
          {% when 1 %}
            {% assign faq_question_key = 'sections.faq.questions.q1.question' %}
            {% assign faq_answer_key = 'sections.faq.questions.q1.answer' %}
          {% when 2 %}
            {% assign faq_question_key = 'sections.faq.questions.q2.question' %}
            {% assign faq_answer_key = 'sections.faq.questions.q2.answer' %}
          {% when 3 %}
            {% assign faq_question_key = 'sections.faq.questions.q3.question' %}
            {% assign faq_answer_key = 'sections.faq.questions.q3.answer' %}
          {% when 4 %}
            {% assign faq_question_key = 'sections.faq.questions.q4.question' %}
            {% assign faq_answer_key = 'sections.faq.questions.q4.answer' %}
          {% when 5 %}
            {% assign faq_question_key = 'sections.faq.questions.q5.question' %}
            {% assign faq_answer_key = 'sections.faq.questions.q5.answer' %}
          {% when 6 %}
            {% assign faq_question_key = 'sections.faq.questions.q6.question' %}
            {% assign faq_answer_key = 'sections.faq.questions.q6.answer' %}
        {% endcase %}
        {% if use_locale_copy and faq_question_key != blank %}
          {% assign faq_question = faq_question_key | t %}
          {% assign faq_answer = faq_answer_key | t %}
        {% else %}
          {% if faq_question == blank and faq_question_key != blank %}
            {% assign faq_question = faq_question_key | t %}
          {% endif %}
          {% if faq_answer == blank and faq_answer_key != blank %}
            {% assign faq_answer = faq_answer_key | t %}
          {% endif %}
        {% endif %}
        <div class="faq-item{% if is_first %} open{% endif %}" {{ block.shopify_attributes }}>
          <button class="faq-question" type="button" aria-expanded="{{ is_first }}">
            <span>{{ faq_question }}</span>
            <span class="faq-toggle">{% if is_first %}–{% else %}+{% endif %}</span>
          </button>
          <div class="faq-answer" {% unless is_first %}hidden{% endunless %}>{{ faq_answer }}</div>
        </div>
      {% endif %}
    {% endfor %}
  </div>
</section>

{% schema %}
{
  "name": "FAQ",
  "tag": "section",
  "class": "section-faq",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Überschrift",
      "default": "Du hast Fragen, wir die Antworten"
    },
    {
      "type": "text",
      "id": "subheading",
      "label": "Unterüberschrift",
      "default": "Du findest nicht, wonach du suchst? Besuch unser"
    },
    {
      "type": "url",
      "id": "help_url",
      "label": "Hilfe Link"
    },
    {
      "type": "text",
      "id": "help_text",
      "label": "Hilfe Link Text",
      "default": "Hilfecenter"
    },
    {
      "type": "text",
      "id": "help_suffix",
      "label": "Text nach Link",
      "default": "wir sind da, um dir zu helfen."
    }
  ],
  "blocks": [
    {
      "type": "question",
      "name": "Frage",
      "settings": [
        {
          "type": "text",
          "id": "question",
          "label": "Frage",
          "default": "Was ist Hr²?"
        },
        {
          "type": "richtext",
          "id": "answer",
          "label": "Antwort",
          "default": "<p>Hr² ist ein täglicher Nährstoff-Boost mit über 70 hochwertigen Inhaltsstoffen – darunter Vitamine, Mineralstoffe, Pflanzenstoffe und Bakterienkulturen.</p>"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "FAQ",
      "blocks": [
        { "type": "question", "settings": { "question": "Was ist Hr²?", "answer": "<p>Hr² ist ein täglicher Nährstoff-Boost mit über 70 hochwertigen Inhaltsstoffen – darunter Vitamine, Mineralstoffe, Pflanzenstoffe und Bakterienkulturen. Entwickelt von Expert:innen, wissenschaftlich fundiert und weltweit von High Performern empfohlen.</p>" } },
        { "type": "question", "settings": { "question": "Funktioniert Hr² für meinen Haartyp?", "answer": "<p>Hr² ist für die tägliche, langfristige Unterstützung der Haargesundheit entwickelt – unabhängig von Haartyp oder Haarstruktur.</p>" } },
        { "type": "question", "settings": { "question": "Wirkt es für Frauen und Männer?", "answer": "<p>Ja. Hr² ist für Frauen und Männer entwickelt und unterstützt die Haargesundheit unabhängig vom Geschlecht.</p>" } },
        { "type": "question", "settings": { "question": "Enthält Hr² Arzneistoffe?", "answer": "<p>Nein. Hr² ist ein Nahrungsergänzungsmittel und enthält keine Arzneistoffe.</p>" } },
        { "type": "question", "settings": { "question": "Ich weiß, dass manche Haarwuchs-Behandlungen Nebenwirkungen haben. Gilt das auch für Hr²?", "answer": "<p>Hr² ist als Nahrungsergänzungsmittel in der Regel gut verträglich. Wie bei allen Supplements kann es jedoch individuell zu Unverträglichkeiten kommen.</p>" } },
        { "type": "question", "settings": { "question": "Gibt es ein Risiko, dass Hr² meine Libido senkt?", "answer": "<p>Hr² enthält keine Arzneistoffe und ist nicht darauf ausgerichtet, in den Hormonhaushalt einzugreifen.</p>" } }
      ]
    }
  ]
}
{% endschema %}
